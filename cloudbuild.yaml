steps:
- name: node:16.14.0
  entrypoint: yarn
  args: ["install"]
- name: node:16.14.0
  entrypoint: yarn
  args: ["build"]
- name: node:16.14.0
  entrypoint: yarn
  args: ["create-env"]
  env:
    - "DB_NAME=${_DB_NAME}"
    - "DB_USER=${_DB_USER}"
    - "DB_USER_PWD=${_DB_USER_PWD}"
    - "DB_HOST=${_DB_HOST}"
    - "WC_CONSUMER_KEY=${_WC_CONSUMER_KEY}"
    - "WC_CONSUMER_SECRET=${_WC_CONSUMER_SECRET}"
- name: "gcr.io/cloud-builders/gcloud"
  args: ["app", "deploy", "--quiet", "app.yaml", "--project", "regal-operations-defy", "--version", "service-default", "--no-promote"]
timeout: "1600s"